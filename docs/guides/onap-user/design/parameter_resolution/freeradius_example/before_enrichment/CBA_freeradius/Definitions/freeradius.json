{
	"tosca_definitions_version": "controller_blueprint_1_0_0",
	"metadata": {
		"template_author": "Abdelmuhaimen Seaudi",
		"author-email": "abdelmuhaimen.seaudi@orange.com",
		"user-groups": "ADMIN, OPERATION",
		"template_name": "freeradius",
		"template_version": "1.0.0",
		"template_tags": "test, freeradius, freeradius_cds"
	},
	"imports": [{
		"file": "Definitions/data_types.json"
	},
	{
		"file": "Definitions/relationship_types.json"
	},
	{
		"file": "Definitions/artifact_types.json"
	},
	{
		"file": "Definitions/node_types.json"
	},
	{
		"file": "Definitions/policy_types.json"
	}],
	"dsl_definitions": {
		"ipam-1": {
			"type": "token-auth",
			"url": "http://netbox-nginx:8080",
			"token": "Token 0123456789abcdef0123456789abcdef01234567"
		},
		"config-deploy-properties": {
			"resolution-key": {
				"get_input": "resolution-key"
			},
			"freeradius_ip": {
				"get_input": "freeradius_ip"
			}			
		},
		"dynamic-db-source": {
			"type": "maria-db",
			"url": "jdbc:mysql://mariadb-galera:3306/sdnctl",
			"username": "root",
			"password": "secretpassword"
		}
	},
	"topology_template": {
		"workflows": {
			"resource-assignment": {
				"steps": {
					"resource-assignment": {
						"description": "Resource Assign Workflow",
						"target": "resource-assignment"
					}
				},
				"inputs": {
					"template-prefix": {
						"required": true,
						"type": "list",
						"entry_schema": {
							"type": "string"
						}
					},
					"resource-assignment-properties": {
						"description": "Dynamic PropertyDefinition for workflow(resource-assignment).",
						"required": true,
						"type": "dt-resource-assignment-properties"
					}
				},
				"outputs": {
					"meshed-template": {
						"type": "json",
						"value": {
							"get_attribute": ["resource-assignment",
							"assignment-params"]
						}
					}
				}
			},
			"config-assign": {
				"steps": {
					"config-assign": {
						"description": "Config Assign Workflow",
						"target": "config-assign",
						"activities": [{
							"call_operation": ""
						}]
					}
				},
				"inputs": {
					"resolution-key": {
						"required": true,
						"type": "string"
					},
					"config-assign-properties": {
						"description": "Dynamic PropertyDefinition for workflow(config-assign).",
						"required": true,
						"type": "dt-config-assign-properties"
					}
				},
				"outputs": {
					"dry-run": {
						"type": "json",
						"value": {
							"get_attribute": ["config-assign",
							"assignment-params"]
						}
					}
				}
			},
			"config-deploy": {
				"steps": {
					"config-deploy": {
						"description": "Resource Assign and Python Netconf Activation Workflow",
						"target": "config-deploy-process",
						"activities": [{
							"call_operation": "ComponentScriptExecutor.process"
						}]
					}
				},
				"inputs": {
					"resolution-key": {
						"required": false,
						"type": "string"
					},
					"service-instance-id": {
						"required": false,
						"type": "string"
					},
					"freeradius_ip": {
						"required": false,
						"type": "string"
					},					
					"config-deploy-properties": {
						"description": "Dynamic PropertyDefinition for workflow(config-deploy).",
						"required": true,
						"type": "dt-config-deploy-properties"
					}
				}
			}
		},
		"node_templates": {
			"resource-assignment": {
				"type": "component-resource-resolution",
				"interfaces": {
					"ResourceResolutionComponent": {
						"operations": {
							"process": {
								"inputs": {
									"artifact-prefix-names": {
										"get_input": "template-prefix"
									}
								}
							}
						}
					}
				},
				"artifacts": {
					"vnf-template": {
						"type": "artifact-template-velocity",
						"file": "Templates/vnf-template.vtl"
					},
					"vnf-mapping": {
						"type": "artifact-mapping-resource",
						"file": "Templates/vnf-mapping.json"
					},
					"radius-template": {
						"type": "artifact-template-velocity",
						"file": "Templates/radius-template.vtl"
					},
					"radius-mapping": {
						"type": "artifact-mapping-resource",
						"file": "Templates/radius-mapping.json"
					}
				}
			},
			"config-assign": {
				"type": "component-resource-resolution",
				"interfaces": {
					"ResourceResolutionComponent": {
						"operations": {
							"process": {
								"inputs": {
									"resolution-key": {
										"get_input": "resolution-key"
									},
									"store-result": true,
									"artifact-prefix-names": ["userconfig"]
								}
							}
						}
					}
				},
				"artifacts": {
					"userconfig-template": {
						"type": "artifact-template-velocity",
						"file": "Templates/userconfig-template.vtl"
					},
					"userconfig-mapping": {
						"type": "artifact-mapping-resource",
						"file": "Templates/userconfig-mapping.json"
					}
				}
			},
			"config-deploy-process": {
				"type": "component-script-executor",
				"interfaces": {
					"ComponentScriptExecutor": {
						"operations": {
							"process": {
								"inputs": {
									"script-type": "kotlin",
									"script-class-reference": "org.onap.ccsdk.cds.blueprintsprocessor.services.execution.scripts.SampleScriptComponent",
									"instance-dependencies": [],
									"dynamic-properties": "*config-deploy-properties"
								}
							}
						}
					}
				}
			}
		}
	}
}